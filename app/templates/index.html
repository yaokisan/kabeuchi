<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KabeUchi - æ€è€ƒã®å£æ‰“ã¡ã‚¢ãƒ—ãƒª</title>
    <!-- QuillJSã‚¹ã‚¿ã‚¤ãƒ«ã‚·ãƒ¼ãƒˆ -->
    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
    <!-- ã‚«ã‚¹ã‚¿ãƒ CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <!-- Socket.IO -->
    <script src="https://cdn.socket.io/4.6.0/socket.io.min.js"></script>
    <!-- Auth token helper -->
    <script src="{{ url_for('static', filename='js/auth.js') }}?v=20240507"></script>
    <style>
        /* ç”»åƒãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”¨ã®ç°¡å˜ãªã‚¹ã‚¿ã‚¤ãƒ« */
        #image-preview-container {
            padding: 5px 10px 0 10px;
            max-height: 100px; /* ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã®é«˜ã•ã‚’åˆ¶é™ */
            overflow: hidden;
            position: relative; /* å‰Šé™¤ãƒœã‚¿ãƒ³ã®ä½ç½®åŸºæº– */
            border-top: 1px solid var(--border-color); /* ä¸Šã«ç·šè¿½åŠ  */
        }
        #image-preview-container img {
            max-width: 100%;
            max-height: 90px; /* ã‚³ãƒ³ãƒ†ãƒŠã‚ˆã‚Šå°‘ã—å°ã•ã */
            display: block;
            border-radius: 4px;
            border: 1px solid var(--border-color);
        }
        #remove-image-btn {
            position: absolute;
            top: 8px;
            right: 15px;
            background: rgba(0,0,0,0.6);
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            font-size: 12px;
            width: 18px;
            height: 18px;
            line-height: 16px;
            text-align: center;
            padding: 0;
        }
        /* æ–‡å­—ã‚µã‚¤ã‚ºå¤‰æ›´UIç”¨ */
        .font-size-selector {
            margin-left: auto;
            margin-right: 15px;
            display: flex;
            align-items: center;
            font-size: 12px;
        }
        .font-size-selector label {
            margin-right: 5px;
            color: var(--text-light);
        }
        .font-size-selector select {
            padding: 3px 6px;
            font-size: 12px;
            width: auto; /* å¹…ã‚’è‡ªå‹•ã« */
            border-radius: 3px;
        }
        /* ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒ˜ãƒƒãƒ€ãƒ¼å†…ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ */
        .document-actions {
             margin-left: 10px;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- ã‚µã‚¤ãƒ‰ãƒãƒ¼ -->
        <div class="sidebar">
            <div class="sidebar-header">
                <a href="{{ url_for('index') }}" class="app-title-link">
                    <h2>KabeUchi</h2>
                </a>
                <!-- â–¼â–¼â–¼ ã‚µã‚¤ãƒ‰ãƒãƒ¼éè¡¨ç¤ºãƒœã‚¿ãƒ³ (ãƒ˜ãƒƒãƒ€ãƒ¼ã¸ç§»å‹•) â–¼â–¼â–¼ -->
                <button id="toggle-sidebar-btn" class="toggle-panel-btn" title="ã‚µã‚¤ãƒ‰ãƒãƒ¼ã‚’éš ã™">â—€</button>
                <!-- â–²â–²â–² ã‚µã‚¤ãƒ‰ãƒãƒ¼éè¡¨ç¤ºãƒœã‚¿ãƒ³ â–²â–²â–² -->
            </div>
            
            <!-- æ–°è¦ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä½œæˆãƒœã‚¿ãƒ³ -->
            <button id="new-document-btn" class="primary-btn pulse-animation">æ–°è¦ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ</button>
            
            <!-- AIãƒ¢ãƒ‡ãƒ«é¸æŠ -->
            <div class="model-selector">
                <label for="ai-model">AIãƒ¢ãƒ‡ãƒ«:</label>
                <select id="ai-model">
                    <option value="gemini-2.0-flash">Gemini 2.0 Flash</option>
                    <option value="gemini-2.5-pro-exp-03-25">gemini-2.5-pro-exp-03-25</option>
                    <option value="gemini-2.5-pro-preview-05-06">gemini-2.5-pro-preview-05-06</option>
                    <option value="claude-3-7-sonnet-20250219">Claude 3.7 Sonnet</option>
                    <option value="gpt-4o">GPT-4o</option>
                    <option value="gpt-4.5-preview">GPT-4.5 Preview</option>
                    <option value="o3">GPT-o3</option>
                </select>
            </div>
            
            <!-- Claudeæ€è€ƒãƒ¢ãƒ¼ãƒ‰ï¼ˆClaudeãƒ¢ãƒ‡ãƒ«é¸æŠæ™‚ã®ã¿è¡¨ç¤ºï¼‰ -->
            <div id="claude-thinking-mode" class="thinking-mode" style="display: none;">
                <label for="thinking-toggle">æ€è€ƒãƒ¢ãƒ¼ãƒ‰:</label>
                <label class="switch">
                    <input type="checkbox" id="thinking-toggle">
                    <span class="slider round"></span>
                </label>
            </div>
            
            <!-- æœ€è¿‘ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä¸€è¦§ -->
            <div class="recent-documents">
                <h3>æœ€è¿‘ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ</h3>
                <ul id="recent-docs-list">
                    <!-- å‹•çš„ã«è¿½åŠ ã•ã‚Œã¾ã™ -->
                </ul>
            </div>
            
            <!-- ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç®¡ç†ãƒšãƒ¼ã‚¸ã¸ã®ãƒªãƒ³ã‚¯ -->
            <a href="{{ url_for('manage_documents') }}" class="manage-link">ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç®¡ç†</a>
            <!-- è¨­å®šãƒšãƒ¼ã‚¸ã¸ã®ãƒªãƒ³ã‚¯ -->
            <a href="{{ url_for('settings') }}" class="settings-link">è¨­å®š</a>

            <!-- ãƒ­ã‚°ã‚¤ãƒ³ä¸­ãƒ¦ãƒ¼ã‚¶è¡¨ç¤º -->
            <div class="login-info"><span class="user-email"></span> ã§ãƒ­ã‚°ã‚¤ãƒ³ä¸­</div>

            <!-- ãƒ­ã‚°ã‚¢ã‚¦ãƒˆãƒœã‚¿ãƒ³ï¼ˆã‚µã‚¤ãƒ‰ãƒãƒ¼ä¸‹éƒ¨ï¼‰ -->
            <button onclick="logout()" class="secondary-btn logout-btn">ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ</button>
        </div>
        
        <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¨ãƒªã‚¢ -->
        <div class="main-content">
            <!-- ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚¿ã‚¤ãƒˆãƒ« -->
            <div class="document-header">
                <input type="text" id="document-title" placeholder="ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚¿ã‚¤ãƒˆãƒ«" value="ç„¡é¡Œã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ">
                <div class="font-size-selector">
                    <label for="editor-font-size">æ–‡å­—ã‚µã‚¤ã‚º:</label>
                    <select id="editor-font-size">
                        <option value="50">50%</option>
                        <option value="60">60%</option>
                        <option value="70">70%</option>
                        <option value="80">80%</option>
                        <option value="90">90%</option>
                        <option value="100" selected>100%</option>
                        <option value="110">110%</option>
                        <option value="120">120%</option>
                        <option value="130">130%</option>
                        <option value="140">140%</option>
                        <option value="150">150%</option>
                    </select>
                </div>
                <div class="document-actions">
                    <button id="save-document-btn" class="action-btn" title="ä¿å­˜">
                        <span class="btn-icon">ğŸ’¾</span>
                    </button>
                </div>
                <div id="save-status">ä¿å­˜æ¸ˆã¿</div>
            </div>
            
            <!-- ã‚¨ãƒ‡ã‚£ã‚¿ã‚³ãƒ³ãƒ†ãƒŠ -->
            <div id="editor-container">
                <!-- QuillJSã‚¨ãƒ‡ã‚£ã‚¿ãŒæŒ¿å…¥ã•ã‚Œã¾ã™ -->
            </div>
        </div>
        
        <!-- ãƒãƒ£ãƒƒãƒˆã‚¨ãƒªã‚¢ -->
        <div class="chat-area">
            <!-- â–¼â–¼â–¼ ãƒãƒ£ãƒƒãƒˆæ¬„éè¡¨ç¤ºãƒœã‚¿ãƒ³ (ãƒ˜ãƒƒãƒ€ãƒ¼å†…ã¸ç§»å‹•) â–¼â–¼â–¼ -->
            <div class="chat-header">
                <h3>AIãƒãƒ£ãƒƒãƒˆ</h3>
                <button id="reset-chat-btn" class="reset-btn" title="ãƒãƒ£ãƒƒãƒˆå±¥æ­´ã‚’ãƒªã‚»ãƒƒãƒˆ">ğŸ—‘ï¸</button>
                <button id="toggle-chat-btn" class="toggle-panel-btn" title="ãƒãƒ£ãƒƒãƒˆæ¬„ã‚’éš ã™">â–¶</button>
            </div>
            <!-- â–²â–²â–² ãƒãƒ£ãƒƒãƒˆæ¬„éè¡¨ç¤ºãƒœã‚¿ãƒ³ â–²â–²â–² -->
            <div class="chat-resize-handle"></div>
            
            <div class="chat-messages" id="chat-messages">
                <!-- ãƒãƒ£ãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒå‹•çš„ã«è¿½åŠ ã•ã‚Œã¾ã™ -->
            </div>
            
            <!-- è¿½åŠ ã•ã‚ŒãŸã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ (åˆæœŸéè¡¨ç¤º) -->
            <div id="chat-context-indicator" class="context-indicator" style="display: none;">
                <span>text</span>
                <button id="clear-chat-context-btn" class="clear-context-btn">Ã—</button>
            </div>
            
            <!-- æ¤œç´¢ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ -->
            <div class="search-toggle-container" style="display: none;">
                <input type="checkbox" id="enable-search-checkbox">
                <label for="enable-search-checkbox">Webæ¤œç´¢ã‚’æœ‰åŠ¹ã«ã™ã‚‹</label>
            </div>

            <!-- â˜… ç”»åƒãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚¨ãƒªã‚¢ã‚’è¿½åŠ  -->
            <div id="image-preview-container" style="display: none;">
                <img id="image-preview" src="#" alt="Image preview"/>
                <button id="remove-image-btn" title="ç”»åƒã‚’å‰Šé™¤">Ã—</button>
            </div>

            <div class="chat-input-container">
                <!-- â˜… éè¡¨ç¤ºã®ãƒ•ã‚¡ã‚¤ãƒ«å…¥åŠ›è¦ç´ ã‚’è¿½åŠ  -->
                <input type="file" id="chat-image-input" accept="image/*" style="display: none;">
                <!-- â˜… ç”»åƒæ·»ä»˜ãƒœã‚¿ãƒ³ã‚’è¿½åŠ  -->
                <button id="attach-image-btn" class="icon-btn" title="ç”»åƒã‚’æ·»ä»˜" style="margin-right: 5px;">
                    <!-- SVGã‚¢ã‚¤ã‚³ãƒ³ -->
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-image" viewBox="0 0 16 16">
                        <path d="M6.002 5.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0"/>
                        <path d="M2.002 1a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2H2zm12 1a1 1 0 0 1 1 1v6.5l-3.777-1.947a.5.5 0 0 0-.577.093l-3.71 3.71-2.66-1.772a.5.5 0 0 0-.63.062L1.002 12V3a1 1 0 0 1 1-1h12z"/>
                    </svg>
                </button>
                <textarea id="chat-input" placeholder="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›... (ç”»åƒã‚‚æ·»ä»˜ã§ãã¾ã™)"></textarea>
                <button id="send-chat-btn">é€ä¿¡</button>
            </div>
        </div>
    </div>
    
    <!-- QuillJSãƒ©ã‚¤ãƒ–ãƒ©ãƒª -->
    <script src="https://cdn.quilljs.com/1.3.6/quill.min.js"></script>
    <!-- marked.jsãƒ©ã‚¤ãƒ–ãƒ©ãƒª (Markdownãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ç”¨) -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <!-- ã‚«ã‚¹ã‚¿ãƒ JavaScript -->
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
    <script src="{{ url_for('static', filename='js/chat.js') }}"></script>
    <script src="{{ url_for('static', filename='js/editor.js') }}"></script>
    <script src="{{ url_for('static', filename='js/chat-resize.js') }}"></script>
</body>
</html> 